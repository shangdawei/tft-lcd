/*
**  ******************************************************************************************
**                                      ALARM
**         (c) Copyright 2009-2010, XXXX CO.LTD.
**                                    All Rights Reserved
**  ==========================================================================================
**	File		: main.c
**  ==========================================================================================
**	Description	: Application enter pointer
**  ==========================================================================================
**  History     : Modify by  ||    ID    ||     Date      ||     Contents
**              :   xul      ||          ||   2009/09/14  || Create this file
**  ******************************************************************************************
*/

#define _MAIN_C_

#include "def.h"
#include "main.h"
#include "key.h"
#include "decode.h"
#include "eeprom.h"
#include "phone.h"

STWORK gSysinfo;

static void init_devices(void);
static void decice_test(void);
int main(void)
{
	init_devices();	//init devices
	decice_test();	//设备自我检测
	while(1)
	{
		key_process();//key process
		
		/*decode*/
	//	if(recv_code() == 1)
		{
			decode_process();
		}

	//	watch_dog();//最后加上
	}
}

/*  $Function   :   init_devices
==  ==============================================================================================
==  Description :   器件的初始化在这里
==  ==============================================================================================
==  Argument    :   
==  ==============================================================================================
==  Return      :   
==              :   
==  ===============================================================================================
==  History     : Modify by  ||    ID    ||     Date      ||     Contents
==              :   xul      ||          ||   2009/11/5   || Create this function
==  ===============================================================================================
*/
static void init_devices(void)
{
	phone_work_read(&gSysinfo);
	gSysinfo.is_key_open = KEY_CLOSE;//调正为键盘关闭
	//其他初始化看着办
	phone_init();//来电中断初始化
}
/*  $Function   :   decice_test
==  ==============================================================================================
==  Description :   器件的自我检测
==  ==============================================================================================
==  Argument    :   
==  ==============================================================================================
==  Return      :   
==              :   
==  ===============================================================================================
==  History     : Modify by  ||    ID    ||     Date      ||     Contents
==              :   xul      ||          ||   2009/11/5   || Create this function
==  ===============================================================================================
*/
static void decice_test(void)
{
	//所有LED闪烁几下
	//蜂鸣器和警铃叫几下
}
/*  $Function   :   alarm_output
==  ==============================================================================================
==  Description :   报警器报警输出
==  ==============================================================================================
==  Argument    :   
==  ==============================================================================================
==  Return      :   
==              :   
==  ===============================================================================================
==  History     : Modify by  ||    ID    ||     Date      ||     Contents
==              :   xul      ||          ||   2009/10/9   || Create this function
==  ===============================================================================================
*/
void alarm_output(bool val)
{
	 //PD3
	//需考虑鸣响时间
}

/*=============================================================================
==============================END OF THE FILE==================================
==============================================================================*/
